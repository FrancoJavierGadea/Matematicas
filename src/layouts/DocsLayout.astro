---
import Layout from "@layouts/Layout.astro";
import { getCollection } from "astro:content";
import {getFileSystemStruture} from "@utils/CollectionUtils.js";

const { title, currentPage, } = Astro.props;

const docs = await getCollection('docs');

const fileStructure = getFileSystemStruture(docs);

if(currentPage){

    const item = currentPage.split('/').reduce((acc, key) => {

        if(acc) acc.open = true;

        return !acc ? 
            fileStructure.find(({name}) => name === key)
            :
            acc.children.find(({name}) => name === key)
        ;

    }, null);

    item.active = true; 
}

const sideBarLinks = [
    ...fileStructure   
]


---


<Layout title={title} showSidebar sideBarTitle={'Docs'} sideBarLinks={sideBarLinks}>

    <slot />

</Layout>